<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>MALIQ Admin</title>
    <!-- CSP YOK - Netlify headers handle edecek -->
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
</head>
<body>
    <div id="cms-root">
        <div style="text-align: center; padding: 50px;">
            <h2>CMS YÃ¼kleniyor...</h2>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const config = {
            backend: {
                name: "github",
                repo: "candoruk96/maliq.github.io",
                branch: "main"
            },
            media_folder: "static/images",
            public_folder: "/images",
            collections: [{
                name: "recipes",
                label: "Tarifler",
                folder: "content/recipes",
                create: true,
                slug: "{{slug}}",
                fields: [
                    { name: "title", label: "Yemek AdÄ±", widget: "string" },
                    { name: "emoji", label: "Emoji", widget: "string", required: false },
                    { name: "category", label: "Kategori", widget: "string" },
                    { 
                        label: "Malzemeler",
                        name: "ingredients",
                        widget: "list",
                        fields: [
                            { name: "name", label: "Ad", widget: "string" },
                            { name: "qty", label: "Miktar", widget: "string" },
                            { name: "unit", label: "Birim", widget: "string" }
                        ]
                    },
                    { name: "instructions", label: "Tarif Metni", widget: "markdown" }
                ]
            }]
        };

        setTimeout(function() {
            if (typeof CMS !== 'undefined') {
                console.log('CMS baÅŸarÄ±yla yÃ¼klendi!');
                CMS.init({ config });
                document.getElementById('cms-root').innerHTML = '';
            } else {
                console.error('CMS yÃ¼klenemedi');
                document.getElementById('cms-root').innerHTML = 
                    '<div style="text-align: center; padding: 50px; color: red;">' +
                    '<h2>ðŸš¨ CSP ENGELÄ°</h2>' +
                    '<p>Netlify CSP ayarlarÄ± "eval" kullanÄ±mÄ±nÄ± engelliyor.</p>' +
                    '<p><strong>Ã‡Ã¶zÃ¼m:</strong> _headers veya netlify.toml dosyasÄ± ekleyin.</p>' +
                    '</div>';
            }
        }, 3000);
    });
    </script>
</body>
</html>
